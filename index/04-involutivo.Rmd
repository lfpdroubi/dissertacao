# O Método Involutivo {#involutivo}

```{r, include = FALSE}
library(rvest)
library(knitr)
library(kableExtra)
type <- knitr::opts_knit$get("rmarkdown.pandoc.to")
```

Segundo a NBR14653-01 [-@NBR1465301, 14], o método involutivo "identifica o
valor do bem, alicerçado no seu aproveitamento eficiente, baseado em modelo de
estudo de viabilidade técnico-econômica, **mediante hipotético empreendimento
compatível** com as características do bem e **com as condições de mercado no
qual está inserido**, considerando-se cenários viáveis para a execução e
comercialização do produto. O método involutivo pode identificar o valor de
mercado. No caso da utilização de premissas especiais, o resultado é um valor
especial."

Apesar de laboriosa, os resultados obtidos com a aplicação do método são repletos
de incertezas, pois as variáveis e os riscos envolvidos não são facilmente 
mensuráveis.

As incertezas vão desde à manutenção dos custos de construção previstos, até aos
valores de comercialização do empreendimento e sua velocidade de vendas, 
passando pelas incertezas quanto às variáveis macroeconômicas vigentes.

## Incertezas em relação às variáveis de entrada

A construção civil, especialmente nos países em desenvolvimento, onde a 
indústria da construção ainda não é totalmente desenvolvida, uma atividade com
alta participação de trabalho artesanal, onde os custos e os prazos podem
facilmente escapar do controle dos administradores.

Além desta peculiaridade do setor, ainda existem as incertezas inerentes à 
situação econômica do país, estado ou cidade em que se desenvolvem as atividades,
que podem alterar as previsões iniciais de custos e receitas previstas para o
empreendimento.

### Análises de sensibilidade

A Engenharia de Avaliações, na busca de tentar lidar com estas incertezas, 
estabeleceu algumas análises de sensibilidade para as variáveis de entrada do
método involutivo. No entanto, estas análises de sensibilidade são aplicadas
de maneira separada para cada variável, todas as outras permanecendo constantes,
*i.e.* incluída a condição *coeteris paribus*. Ocorre que, como se sabe, a 
condição *coeteris paribus* raramente se aplica, pois uma variável está
sempre de alguma maneira relacionada com a outra. 

### Simulações 

Haja vista o problema relatado com as análises de sensibilidade, onde o 
estabelecimento da cláusula *coeteris paribus* é meramente teórica, tendo
pouca validade prática, o uso de simulações, onde são consideradas relações
entre as variáveis de entrada, se fazem necessárias.

Em @gahochheim foram realizadas simulações considerando-se diversas hipóteses, 
tais como a distribuição de probabilidades *a priori* e a dependência entre as
variáveis. No entanto, foram modeladas apenas dependências teóricas entre as
variáveis (independência total, dependência total e 50% de independência).

A escolha da distribuição *a priori* das variáveis influencia no resultado final
das simulações. No entanto, entende-se que uma correta definição da correlação 
entre as variáveis seja de maior importância, especialmente quando se trata
de análises de risco de um empreendimento.

Segundo @matloff2017, o *princípio da ocorrência frequente de eventos extremos*
afirma que, apesar da pequena probabilidade de ocorrência de um evento, sendo
o número de repetições de uma experiência suficientemente alto, a tendência é 
que este evento ocorrerá. De maneira que considera-se que a distribuição
uniforme de probabilidades *a priori* para cada variável seja uma boa hipótese.

...

A relação entre as variáveis, no entanto, pode ser

Outra importante observação que se deve fazer é como o mercado em que o 
empreendimento se encontra afeta a correlação entre estas variáveis. 

Num mercado de concorrência perfeita, por exemplo, um aumento de custos não 
poderá ser repassado ao consumidor sem perda de *market share*, ou seja, a 
tendência é que as firmas absorvam o aumento de custos perdendo margem de lucro.

Já num mercado monopolista, a tendência é repassar o aumento de preços ao 
consumidor, mantendo-se os lucros do monopolista.

@gahochheim, a partir de simulações com diversos cenários, concluiu que a 
variável fluxo de vendas foi a variável mais impactante na formação do valor
de um empreendimento hipotético. No entanto, como salienta @gahochheim 
[-@gahochheim, 119], esta variável está intimamente correlacionada com a 
variável taxa mínima de atratividade, o que torna importante a correta definição
desta taxa.

#### A taxa mínima de atratividade

Na prática atual da Engenharia de Avaliações convencionou-se o estabelecimento
de uma taxa mínima de atratividade igual a um múltiplo da taxa de juros de curto
prazo, ou taxa selic, usualmente feito igual a 3.

No entanto, considera-se que este parâmetro é injustificado e pode ser, no 
mínimo, contestado, ainda mais em se tratando de uma possível perícia judicial
para o estabelecimento do valor de um imóvel.

Ora, a taxa mínima de atratividade de um empreendimento qualquer não pode ser
inferior a taxa dos títulos de dívida pública do governo **de _duration_ similar
à duração do empreendimento**, haja vista que o investimento em títulos públicos
pode ser considerado um investimento livre de risco. 

```{r TD}
# url_data <- read_html("http://www.tesouro.fazenda.gov.br/tesouro-direto-precos-e-taxas-dos-titulos")
# bonds <- url_data %>%
#   html_nodes(xpath = "//table[@class='tabelaPrecoseTaxas']") %>%
#   html_table(header = TRUE, fill = TRUE, dec = ",")
# bonds_df <- bonds[[1]][, 1:5] 
# bonds_df <- bonds_df[complete.cases(bonds_df), ]
# colnames(bonds_df) <- c("Título", "Vencimento", "% a.a.", "Valor Mínimo", "P. U.")
# saveRDS(bonds_df, "data/TD")
bonds_df <- readRDS("data/TD")
bonds_df %>% 
  kable(caption = "Preços e taxas de referência dos títulos públicos",
        format = ifelse(type == "html", "markdown", type),
        row.names = FALSE,
        align = c('l', 'c', 'r', 'r', 'r'),
        digits = 2,
        format.args = c(decimal.mark = ",", big.mark = "."),
        booktabs = TRUE) %>%
  kable_styling(latex_option = "striped",
                bootstrap_options = "striped",
                stripe_index = c(1, 7, 10),
                full_width = FALSE) %>%
  column_spec(1, width = "5cm") %>% 
  column_spec(4, width = "1.5cm") %>% 
  pack_rows("Indexados ao IPCA", 1, 6) %>%
  pack_rows("Prefixados", 7, 9) %>%
  pack_rows("Indexados à Taxa Selic", 10, 10) %>% 
  add_footnote("\\href{http://www.tesouro.fazenda.gov.br/tesouro-direto-precos-e-taxas-dos-titulos}{Tesouro Direto}", escape = FALSE, notation = "symbol")
```

Ou seja, estabelecido um cronograma para o empreendimento como um todo,
incluindo a fase de vendas, a taxa livre de risco pode ser determinada com
precisão. Porém, a taxa livre de risco apenas é estabelecida no momento da
aplicação do método, desconsiderando-se que esta taxa tem livre flutuação e
grande impacto na formação do preço final do imóvel.

Resta ainda a determinação da taxa de risco a ser embutido na taxa mínima de
atratividade, juntamente com a taxa livre de risco, através, por exemplo, do
*Capital Asset Pricing Model*, como descrito em @gahochheim [-@gahochheim, 69-73], 
de acordo com a fórmula abaixo:

$$\gls{R_e}= \gls{R_f} + \beta(\gls{R_m} - R_f)$$

Inexiste, para tal, método exato de cálculo, como salienta @gahochheim, donde
deve-se permitir alguma variação para a entrada da taxa mínima de atratividade
nas simulações.

Porém, não apenas a variação devido à inexatidão da taxa de risco deveria
ser embutida nas simulações, mas também uma variação devido à possíveis 
flutuações da taxa livre de risco.

Outra questão de suma importância é que, assim como a taxa mínima de
atratividade influencia no cálculo do valor do imóvel através da variável fluxo
de vendas, através da mudança da taxa de desconto aplicada ao fluxo de caixa
para o cálculo do valor presente, ela também exerce influencia sobre o preço de
venda das unidades, como visto no capítulo \@ref(economia), impactando também o
fluxo de caixa do empreendimento, desta vez não pela variação da taxa de 
desconto aplicada, mas pela variação da magnitude do valor das vendas. 

#### O valor de venda

Usualmente, para aplicação no método involutivo, é considerado um valor de venda
fixo, calculado através do método comparativo direto de dados de mercado
(MCDDM), feito em momento anterior ao empreendimento. Alguma variação dos preços
de venda é permitida apenas dentro do intervalo de confiança do preço calculado
à partir do MCDDM.

Esta análise é questionável, pois o MCDDM é um retrato do mercado para aquele
momento, *i.e.*, ele é válido apenas para a data de referência em que foi
aplicado, mas o valor de venda pode variar durante a execução do empreendimento,
ou ainda durante as vendas dos imóveis, após a conclusão do mesmo.

Especialmente, o valor de venda, como visto no capítulo \@ref(economia), está
intimamente relacionado com as variáveis macroeconômicas, em especial à taxa de
juros de longo prazo, e de maneira não-linear. No entanto, é fácil demonstrar 
que a linearização da relação entre o valor justo de um imóvel e a taxa de juros
pode ser realizada pela simples transformação do valor pela função inversa, 
como é mostrado na figura \@ref(fig:valores-juros-rec).

```{r valores-juros-rec, fig.cap = "Variação do valor justo de um imóvel em função da taxa de juros."}
eq = function(x) 12*2000/(x)
# curve(eq, from=.1/100, to = 6/100,
#       xlab = "Taxa de juros",
#       ylab = "Valor justo do Imóvel"
#       )
ggplot(data.frame(x = c(.1/100, 6/100)), aes(x = x)) + 
  stat_function(fun = eq) + 
  xlab("Taxa de juros (ao ano)") +
  ylab("1 / Valor justo do imóvel") +
  scale_y_continuous(trans = "reciprocal") +
  scale_x_continuous(labels = scales::percent) +
  labs(title = "Valor justo de um imóvel", 
       subtitle = "Em milhões de reais.",
       caption = "Supondo um aluguel constante de R$2.000/mês.") 
  
```

Outra maneira de se linearizar a relação entre as variáveis é através da
transformação de ambas pela função logarítmica, como mostra a figura
\@ref(fig:valores-juros-log).

```{r valores-juros-log, fig.cap = "Variação do valor justo de um imóvel em função da taxa de juros."}
ks <- function (x) { number_format(accuracy = 1,
                                   scale = 1/10^3,
                                   suffix = "k",
                                   big.mark = ".",
                                   decimal.mark = ",")(x) }
eq = function(x) 12*2000/(x)
# curve(eq, from=.1/100, to = 6/100,
#       xlab = "Taxa de juros",
#       ylab = "Valor justo do Imóvel"
#       )
ggplot(data.frame(x = c(.1/100, 6/100)), aes(x = x)) + 
  stat_function(fun = eq) + 
  xlab("Taxa de juros") +
  ylab("Valor justo do imóvel") +
  scale_y_continuous(trans = "log",
                     breaks = scales::log_breaks(n = 10),
                     labels = ks) +
  scale_x_continuous(trans = "log",
                     breaks = scales::log_breaks(n = 10),
                     labels = scales::percent_format(accuracy = .1,
                                                     decimal.mark = ",")) +
  labs(title = "Valor justo de um imóvel",
       subtitle = "Em milhares de reais.",
       caption = "Supondo um aluguel constante de R$2.000/mês.") 
  
```

### Estimação de intervalos de confiança para os valores à partir das simulações de Monte Carlo

